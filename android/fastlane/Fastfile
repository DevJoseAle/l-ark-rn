# This file contains the fastlane.tools configuration
# You can find the documentation at https://docs.fastlane.tools
#
# For a list of all available actions, check out
#
#     https://docs.fastlane.tools/actions
#
# For a list of all available plugins, check out
#
#     https://docs.fastlane.tools/plugins/available-plugins
#

# Uncomment the line if you want fastlane to automatically update itself
# update_fastlane

default_platform(:android)

platform :android do
  
  # ðŸ§ª LANE: Build de desarrollo (LOCAL - sin subir a Play Console)
  desc "Build APK de desarrollo"
  lane :dev do
    gradle(
      task: "clean assembleRelease",
      project_dir: "."
    )
    
    puts "âœ… APK generado: android/app/build/outputs/apk/release/app-release.apk"
    puts "ðŸ“± Instala en tu dispositivo manualmente"
  end

  # ðŸš€ LANE: Build para Play Console (requiere service account)
  desc "Build AAB y subir a Internal Testing"
  lane :beta do
    gradle(
      task: "clean bundleRelease",
      project_dir: "."
    )
    
    # Solo descomentar cuando tengas configurado el service account JSON
    # upload_to_play_store(
    #   track: 'internal',
    #   aab: 'app/build/outputs/bundle/release/app-release.aab',
    #   json_key: ENV['PLAY_STORE_JSON_KEY']
    # )
    
    puts "âœ… AAB generado: android/app/build/outputs/bundle/release/app-release.aab"
    puts "ðŸ“¤ Sube manualmente a Play Console por ahora"
  end

  # ðŸ“¦ LANE: Build de producciÃ³n
  desc "Build para producciÃ³n"
  lane :release do
    gradle(
      task: "clean bundleRelease",
      project_dir: "."
    )
    
    # Solo descomentar cuando tengas configurado el service account JSON
    # upload_to_play_store(
    #   track: 'production',
    #   aab: 'app/build/outputs/bundle/release/app-release.aab',
    #   json_key: ENV['PLAY_STORE_JSON_KEY']
    # )
    
    puts "âœ… AAB generado para producciÃ³n"
    puts "ðŸ“¤ Sube manualmente a Play Console"
  end

end